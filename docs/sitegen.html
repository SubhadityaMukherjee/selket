<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>selket.sitegen API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>selket.sitegen</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import markdown
import json
from pathlib import Path
from tqdm import tqdm
import http.server
import socketserver
from datetime import datetime

&#34;&#34;&#34;
This module takes care of Markdown -&gt; HTML and generating the site
&#34;&#34;&#34;


def serve():
    &#34;&#34;&#34;
    Local server creation on given port
    &#34;&#34;&#34;
    handler = http.server.SimpleHTTPRequestHandler

    with socketserver.TCPServer((&#34;&#34;, 0), handler) as httpd:
        print(
            &#34;Server started at localhost:&#34;
            + &#34; http://0.0.0.0:&#34;
            + str(httpd.server_address[1])
        )
        httpd.serve_forever()


def count_from_json(js, index, hashed=True):
    &#34;&#34;&#34;
    Since the json for every post is in order, this just returns the element at the position supplied and its count. In most cases, this would be a unique list of elements
    &#34;&#34;&#34;
    counter = []
    for i in js:
        counter.append(js[i][index])
    counter = [x for x in counter if len(x) &gt; 0]
    if hashed == True:
        counter = set(counter)
    return counter, len(counter)


def state_vars():
    &#34;&#34;&#34;
    Read the config, add some extra essentials from the indexed documents
    &#34;&#34;&#34;
    with open(Path.joinpath(Path.cwd(), &#34;config.json&#34;), &#34;r&#34;) as f:
        d_vars = json.load(f)
        indexPath = Path.joinpath(Path.cwd(), &#34;indexed.json&#34;)
        d_vars[&#34;index_path&#34;] = indexPath
        try:
            with open(indexPath, &#34;r&#34;) as f2:
                indexed = json.load(f2)
                d_vars[&#34;total_posts&#34;] = len(indexed.keys())
                d_vars[&#34;categories&#34;] = count_from_json(indexed, 1)[0]
        except FileNotFoundError:
            pass

    return d_vars


def returnIndex(statev):
    strsend = &#34;&lt;ul&gt;\n&#34;
    with open(statev[&#34;index_path&#34;], &#34;r&#34;) as f:
        all_files = json.load(f)

    for i in all_files.keys():
        temp = all_files[i]
        strsend += f&#34;&#34;&#34;&lt;li&gt;
        &lt;a href = ./_compiled/{i.split(&#39;.&#39;)[0]+&#39;.html&#39;}&gt;{temp[3]}&lt;/li&gt;&#34;&#34;&#34;

    return strsend + &#34;\n&lt;ul&gt;\n&#34;


def replacerHTML(fil, statev, conv, meta_lis):
    &#34;&#34;&#34;
    Takes the file, replaces whatever is needed to compile in the html
    &#34;&#34;&#34;
    dict_replacer = {
        &#34;[content]&#34;: conv,
        &#34;[index]&#34;: returnIndex(statev),
        &#34;[total_posts]&#34;: str(statev[&#34;total_posts&#34;]),
        &#34;[title]&#34;: f&#34;&lt;h1&gt;{str(meta_lis[3])}&lt;/h1&gt;\n\n&#34;,
    }

    for i in dict_replacer.keys():
        fil = fil.replace(i, dict_replacer[i])
    return fil


def markToHTML(fpath, statev):
    &#34;&#34;&#34;
    Converts from markdown to HTML given some addons (user can add)
    &#34;&#34;&#34;
    with open(fpath, &#34;r&#34;) as f:
        f = f.read()
        extensions = [&#34;meta&#34;]
        for i in [&#34;fenced_code&#34;, &#34;sane_lists&#34;, &#34;wikilinks&#34;, &#34;toc&#34;]:
            if statev[i] == True:
                extensions.append(i)
        md = markdown.Markdown(extensions=extensions)
        conv = md.convert(f)
        layout = md.Meta[&#34;layout&#34;][0] + &#34;.html&#34;
        with open(Path.joinpath(Path.cwd() / &#34;_layouts/&#34;, layout), &#34;r&#34;) as f2:
            f2 = f2.read()
            meta_lis = []
            for metas in [&#34;layout&#34;, &#34;categories&#34;, &#34;tags&#34;, &#34;title&#34;, &#34;date&#34;]:
                try:
                    if metas == &#34;tags&#34;:
                        meta_lis.append(md.Meta[metas][0].split(&#34; &#34;))
                    else:
                        meta_lis.append(md.Meta[metas][0])
                except KeyError:
                    meta_lis.append(&#34;&#34;)
            layout = md.Meta[&#34;layout&#34;]
            return replacerHTML(f2, statev, conv, meta_lis), meta_lis


def mdtoIndex(fpath):
    with open(fpath, &#34;r&#34;) as f:
        f = f.read()
        md = markdown.Markdown(extensions=[&#34;meta&#34;])
        md.convert(f)
        meta_lis = []
        for metas in [&#34;layout&#34;, &#34;categories&#34;, &#34;tags&#34;, &#34;title&#34;]:
            try:
                if metas == &#34;tags&#34;:
                    meta_lis.append(md.Meta[metas][0].split(&#34; &#34;))
                else:
                    meta_lis.append(md.Meta[metas][0])
            except KeyError:
                meta_lis.append(&#34;&#34;)
        return meta_lis


def create_index(fpath):
    mdLi = [x for x in Path.glob(fpath, &#34;*/*.md&#34;)]
    indexed = {}
    for fil in tqdm(mdLi, total=len(mdLi)):
        mfile = mdtoIndex(fil)
        nm = fil.name
        indexed[nm] = mfile

    with open(Path.cwd() / &#34;indexed.json&#34;, &#34;w+&#34;) as f:
        json.dump(indexed, f, indent=4, sort_keys=True)


def compilemd(fpath, statev):
    &#34;&#34;&#34;
    Goes through all markdown documents. One for the root and the other for the posts directory, converts and compiles them to html with add ons specified and substitues whatever is in the state variables.
    Also indexes the files for access to information
    &#34;&#34;&#34;
    # root directory
    mdLi = [x for x in Path.glob(fpath, &#34;*.md&#34;)]
    for fil in mdLi:
        nm = fil.name
        with open(Path.joinpath(Path.cwd(), nm).with_suffix(&#34;.html&#34;), &#34;w+&#34;) as f:
            f.write(markToHTML(fil, statev)[0])

    # posts directory
    mdLi = [x for x in Path.glob(fpath, &#34;*/*.md&#34;)]
    for fil in tqdm(mdLi, total=len(mdLi)):
        mfile = markToHTML(fil, statev)
        nm = fil.name
        with open(
            Path.joinpath(Path.cwd() / &#34;_compiled&#34;, nm).with_suffix(&#34;.html&#34;), &#34;w+&#34;
        ) as f:
            f.write(mfile[0])</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="selket.sitegen.compilemd"><code class="name flex">
<span>def <span class="ident">compilemd</span></span>(<span>fpath, statev)</span>
</code></dt>
<dd>
<div class="desc"><p>Goes through all markdown documents. One for the root and the other for the posts directory, converts and compiles them to html with add ons specified and substitues whatever is in the state variables.
Also indexes the files for access to information</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def compilemd(fpath, statev):
    &#34;&#34;&#34;
    Goes through all markdown documents. One for the root and the other for the posts directory, converts and compiles them to html with add ons specified and substitues whatever is in the state variables.
    Also indexes the files for access to information
    &#34;&#34;&#34;
    # root directory
    mdLi = [x for x in Path.glob(fpath, &#34;*.md&#34;)]
    for fil in mdLi:
        nm = fil.name
        with open(Path.joinpath(Path.cwd(), nm).with_suffix(&#34;.html&#34;), &#34;w+&#34;) as f:
            f.write(markToHTML(fil, statev)[0])

    # posts directory
    mdLi = [x for x in Path.glob(fpath, &#34;*/*.md&#34;)]
    for fil in tqdm(mdLi, total=len(mdLi)):
        mfile = markToHTML(fil, statev)
        nm = fil.name
        with open(
            Path.joinpath(Path.cwd() / &#34;_compiled&#34;, nm).with_suffix(&#34;.html&#34;), &#34;w+&#34;
        ) as f:
            f.write(mfile[0])</code></pre>
</details>
</dd>
<dt id="selket.sitegen.count_from_json"><code class="name flex">
<span>def <span class="ident">count_from_json</span></span>(<span>js, index, hashed=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Since the json for every post is in order, this just returns the element at the position supplied and its count. In most cases, this would be a unique list of elements</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def count_from_json(js, index, hashed=True):
    &#34;&#34;&#34;
    Since the json for every post is in order, this just returns the element at the position supplied and its count. In most cases, this would be a unique list of elements
    &#34;&#34;&#34;
    counter = []
    for i in js:
        counter.append(js[i][index])
    counter = [x for x in counter if len(x) &gt; 0]
    if hashed == True:
        counter = set(counter)
    return counter, len(counter)</code></pre>
</details>
</dd>
<dt id="selket.sitegen.create_index"><code class="name flex">
<span>def <span class="ident">create_index</span></span>(<span>fpath)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def create_index(fpath):
    mdLi = [x for x in Path.glob(fpath, &#34;*/*.md&#34;)]
    indexed = {}
    for fil in tqdm(mdLi, total=len(mdLi)):
        mfile = mdtoIndex(fil)
        nm = fil.name
        indexed[nm] = mfile

    with open(Path.cwd() / &#34;indexed.json&#34;, &#34;w+&#34;) as f:
        json.dump(indexed, f, indent=4, sort_keys=True)</code></pre>
</details>
</dd>
<dt id="selket.sitegen.markToHTML"><code class="name flex">
<span>def <span class="ident">markToHTML</span></span>(<span>fpath, statev)</span>
</code></dt>
<dd>
<div class="desc"><p>Converts from markdown to HTML given some addons (user can add)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def markToHTML(fpath, statev):
    &#34;&#34;&#34;
    Converts from markdown to HTML given some addons (user can add)
    &#34;&#34;&#34;
    with open(fpath, &#34;r&#34;) as f:
        f = f.read()
        extensions = [&#34;meta&#34;]
        for i in [&#34;fenced_code&#34;, &#34;sane_lists&#34;, &#34;wikilinks&#34;, &#34;toc&#34;]:
            if statev[i] == True:
                extensions.append(i)
        md = markdown.Markdown(extensions=extensions)
        conv = md.convert(f)
        layout = md.Meta[&#34;layout&#34;][0] + &#34;.html&#34;
        with open(Path.joinpath(Path.cwd() / &#34;_layouts/&#34;, layout), &#34;r&#34;) as f2:
            f2 = f2.read()
            meta_lis = []
            for metas in [&#34;layout&#34;, &#34;categories&#34;, &#34;tags&#34;, &#34;title&#34;, &#34;date&#34;]:
                try:
                    if metas == &#34;tags&#34;:
                        meta_lis.append(md.Meta[metas][0].split(&#34; &#34;))
                    else:
                        meta_lis.append(md.Meta[metas][0])
                except KeyError:
                    meta_lis.append(&#34;&#34;)
            layout = md.Meta[&#34;layout&#34;]
            return replacerHTML(f2, statev, conv, meta_lis), meta_lis</code></pre>
</details>
</dd>
<dt id="selket.sitegen.mdtoIndex"><code class="name flex">
<span>def <span class="ident">mdtoIndex</span></span>(<span>fpath)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def mdtoIndex(fpath):
    with open(fpath, &#34;r&#34;) as f:
        f = f.read()
        md = markdown.Markdown(extensions=[&#34;meta&#34;])
        md.convert(f)
        meta_lis = []
        for metas in [&#34;layout&#34;, &#34;categories&#34;, &#34;tags&#34;, &#34;title&#34;]:
            try:
                if metas == &#34;tags&#34;:
                    meta_lis.append(md.Meta[metas][0].split(&#34; &#34;))
                else:
                    meta_lis.append(md.Meta[metas][0])
            except KeyError:
                meta_lis.append(&#34;&#34;)
        return meta_lis</code></pre>
</details>
</dd>
<dt id="selket.sitegen.replacerHTML"><code class="name flex">
<span>def <span class="ident">replacerHTML</span></span>(<span>fil, statev, conv, meta_lis)</span>
</code></dt>
<dd>
<div class="desc"><p>Takes the file, replaces whatever is needed to compile in the html</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def replacerHTML(fil, statev, conv, meta_lis):
    &#34;&#34;&#34;
    Takes the file, replaces whatever is needed to compile in the html
    &#34;&#34;&#34;
    dict_replacer = {
        &#34;[content]&#34;: conv,
        &#34;[index]&#34;: returnIndex(statev),
        &#34;[total_posts]&#34;: str(statev[&#34;total_posts&#34;]),
        &#34;[title]&#34;: f&#34;&lt;h1&gt;{str(meta_lis[3])}&lt;/h1&gt;\n\n&#34;,
    }

    for i in dict_replacer.keys():
        fil = fil.replace(i, dict_replacer[i])
    return fil</code></pre>
</details>
</dd>
<dt id="selket.sitegen.returnIndex"><code class="name flex">
<span>def <span class="ident">returnIndex</span></span>(<span>statev)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def returnIndex(statev):
    strsend = &#34;&lt;ul&gt;\n&#34;
    with open(statev[&#34;index_path&#34;], &#34;r&#34;) as f:
        all_files = json.load(f)

    for i in all_files.keys():
        temp = all_files[i]
        strsend += f&#34;&#34;&#34;&lt;li&gt;
        &lt;a href = ./_compiled/{i.split(&#39;.&#39;)[0]+&#39;.html&#39;}&gt;{temp[3]}&lt;/li&gt;&#34;&#34;&#34;

    return strsend + &#34;\n&lt;ul&gt;\n&#34;</code></pre>
</details>
</dd>
<dt id="selket.sitegen.serve"><code class="name flex">
<span>def <span class="ident">serve</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Local server creation on given port</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def serve():
    &#34;&#34;&#34;
    Local server creation on given port
    &#34;&#34;&#34;
    handler = http.server.SimpleHTTPRequestHandler

    with socketserver.TCPServer((&#34;&#34;, 0), handler) as httpd:
        print(
            &#34;Server started at localhost:&#34;
            + &#34; http://0.0.0.0:&#34;
            + str(httpd.server_address[1])
        )
        httpd.serve_forever()</code></pre>
</details>
</dd>
<dt id="selket.sitegen.state_vars"><code class="name flex">
<span>def <span class="ident">state_vars</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Read the config, add some extra essentials from the indexed documents</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def state_vars():
    &#34;&#34;&#34;
    Read the config, add some extra essentials from the indexed documents
    &#34;&#34;&#34;
    with open(Path.joinpath(Path.cwd(), &#34;config.json&#34;), &#34;r&#34;) as f:
        d_vars = json.load(f)
        indexPath = Path.joinpath(Path.cwd(), &#34;indexed.json&#34;)
        d_vars[&#34;index_path&#34;] = indexPath
        try:
            with open(indexPath, &#34;r&#34;) as f2:
                indexed = json.load(f2)
                d_vars[&#34;total_posts&#34;] = len(indexed.keys())
                d_vars[&#34;categories&#34;] = count_from_json(indexed, 1)[0]
        except FileNotFoundError:
            pass

    return d_vars</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="selket" href="index.html">selket</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="selket.sitegen.compilemd" href="#selket.sitegen.compilemd">compilemd</a></code></li>
<li><code><a title="selket.sitegen.count_from_json" href="#selket.sitegen.count_from_json">count_from_json</a></code></li>
<li><code><a title="selket.sitegen.create_index" href="#selket.sitegen.create_index">create_index</a></code></li>
<li><code><a title="selket.sitegen.markToHTML" href="#selket.sitegen.markToHTML">markToHTML</a></code></li>
<li><code><a title="selket.sitegen.mdtoIndex" href="#selket.sitegen.mdtoIndex">mdtoIndex</a></code></li>
<li><code><a title="selket.sitegen.replacerHTML" href="#selket.sitegen.replacerHTML">replacerHTML</a></code></li>
<li><code><a title="selket.sitegen.returnIndex" href="#selket.sitegen.returnIndex">returnIndex</a></code></li>
<li><code><a title="selket.sitegen.serve" href="#selket.sitegen.serve">serve</a></code></li>
<li><code><a title="selket.sitegen.state_vars" href="#selket.sitegen.state_vars">state_vars</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>